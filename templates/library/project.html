{% extends "base.html" %}
{% load i18n static %}
{% block scripts %}
<script src="{% static "sandbox/js/lib/utils.js" %}"></script>
<script src="{% static "sandbox/js/lib/api.js" %}"></script>
{% endblock %}
{% block body_content %}
<div class="container">
  <section class="project">
    <header>
      <div class="row">
        <div class="col-md-12">
          <ol class="breadcrumb">
            <li class="breadcrumb-item">
              <a href="{% url 'library:collection-list' %}">
                <span class="glyphicon glyphicon-home"></span> {% trans "Home"%}
              </a>
            </li>
            <li class="breadcrumb-item">
              <a href="{% url 'library:project-detail' slug %}">{{ collection.name }} ({{ collection.id }})</a>
            </li>
          </ol>
        </div>
      </div>
    </header>
    <main>
      <div class="row">
        <div class="col-md-12">
          <div class="collection">
            <a href="{% url 'library:project-detail' slug %}">
              <h1>
                {% if collection.title %}
                {{ collection.title }}
                {% else %}
                {{ collection.name }}
                {% endif %}
                ({{ collection.id }})
              </h1>
            </a>
            <p>
              {{ collection.num_docs }} Documents
            </p>
            {% include 'library/includes/progress.html' with items=collection.progress %}
          </div>
        </div>        
      </div>
      <div class="row">
        <div class="col-md-12">
          <form action="{% url 'library:project-detail' slug %}">
            <label for="doc-id">
              {% trans "Document" %}:
            </label>
            <select id="doc-id" name="docId" onchange="this.form.submit();">
              {% for doc in documents %}
              <option value="{{ doc.id }}"{% if selected_document_id == doc.id %} selected{% endif %}>
                {{ doc.title }} ({{ doc.id }})
              </option>
              {% endfor %}
            </select>
          </form>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          {% if not selected_document %}
          <h2>{% trans "No document selected" %}</h2>
          {% else %}
          {% with document=selected_document %}
          <a href="{% url 'library:project-detail' slug %}/?docId={{ document.id }}">
            <h2>{{ document.title }} ({{ document.id }})</h2>
          </a>
          <p>{{ document.num_pages }} Pages</p>
          {% include 'library/includes/progress.html' with items=document.progress %}
          <h3>Pages</h3>
          <div class="page-list">
            <style>
             .page-list .page {
               display: inline-block;
               width: 49%;
             }

             .page-list .page .progress {
               display: inline-block;
               width: 80px;
               margin: 0;
               margin-top: 5px;
             }

             .page-list .page .progress-bar {
               padding: 0;
             }

             .page-list .page .list-inline li {
               vertical-align: middle;
             }

            </style>
            {% for page in document.pages %}
            <div class="page">
              <ul class="list-inline">
                <li>
                  <span class="badge">{{ page.status }}</span>
                </li>
                <li>
                  {% include 'library/includes/progress.html' with items=page.progress %}
                </li>
                <li>
                  <span title="{{ page.num_lines_done }}  of {{ page.num_lines_total }} Lines Transcribed">{{ page.num_lines_done }}  of {{ page.num_lines_total }}</span>
                </li>
                <li>
                  {# <a href="{% url 'sandbox:transcribe' %}?colId={{ collection.id }}&docId={{ document.id }}&pageId={{ page.num }}">View</a> #}
                  <a href="{% url 'sandbox:transcribe' %}?colId={{ collection.id }}&docId={{ document.id }}&pageId={{ page.num }}">Transcribe</a>
                  <a href="{% url 'sandbox:transcribe' %}?colId={{ collection.id }}&docId={{ document.id }}&pageId={{ page.num }}">Proofread</a>
                </li>
              </ul>
            </div>
            {% endfor %}
          </div>
          {% endwith %}
          {% endif %}
        </div>
      </div>
    </main>
  </section>
</div>
{% endblock %}
